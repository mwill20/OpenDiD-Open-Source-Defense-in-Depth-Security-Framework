## TheHive main configuration file

# Secret key
play.http.secret.key="YOUR_SECRET_KEY"

# Database configuration
db {
  provider: janusgraph
  janusgraph {
    storage {
      backend: berkeleyje
      directory: /opt/thp/thehive/db
    }
    index.search {
      backend: lucene
      directory: /opt/thp/thehive/index
    }
  }
}

# Authentication configuration
auth {
  providers: [
    {name: local},
    {name: key}
  ]
  defaultUserDomain: "thehive.local"
}

# CORS configuration
play.filters.cors {
  allowedOrigins: ["*"]
  allowedHttpMethods: ["GET", "POST", "PUT", "DELETE"]
}

# Cortex configuration
cortex {
  servers: [
    {
      name: "local-cortex"
      url: "http://localhost:9001"
      auth {
        type: "bearer"
        key: "YOUR_API_KEY"
      }
    }
  ]
}

# MISP configuration
misp {
  interval: 1 hour
  servers: [
    {
      name: "MISP-SERVER"
      url: "https://YOUR_MISP_URL"
      auth {
        type: "key"
        key: "YOUR_MISP_KEY"
      }
      wsConfig {
        ssl.loose.acceptAnyCertificate: true
      }
    }
  ]
}

# Wazuh Integration
notification {
  webhook {
    endpoints: [
      {
        name: "wazuh"
        url: "http://localhost:55000/api"
        auth {
          type: "basic"
          user: "wazuh_user"
          password: "wazuh_password"
        }
        wsConfig {
          ssl.loose.acceptAnyCertificate: true
        }
      }
    ]
  }
}
